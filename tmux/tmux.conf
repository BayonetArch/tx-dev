# remove the delay with esc
set -s escape-time 0

# Set terminal to support 256 colors
set -g default-terminal "xterm-256color"
set-option -sa terminal-features ',xterm-256color:RGB'
set-option -ga terminal-overrides ",xterm*:Tc"

# Duratio  for displaying status messages
set-option -g display-time 2000

# Set TERMINFO path(very necessary for termux yk) 
set-environment -g TERMINFO "/data/data/com.termux/files/usr/share/terminfo"

set-option -g allow-passthrough on

# Use vi-style keys in copy mode
setw -g mode-keys vi
bind-key -T copy-mode-vi v send -X begin-selection   # Start visual selection
bind-key -T copy-mode-vi y send -X copy-selection-and-cancel  # Yank and exit

# Change prefix key to Ctrl+Space
unbind C-b
set-option -g prefix M-k
bind-key M-k send-prefix

# Reload tmux config with a keybind
bind r source-file ~/.dotfile/.config/tmux/tmux.conf \; display "Config Reloaded"

# Start window numbering at 1
set -g base-index 1

# set-option remain-on-exit on  # (optional) keep pane open if command exits
set -g renumber-windows on       # Auto-renumber windows after closing one
set -g escape-time 0             # Ensure escape delay is 0
set-window-option -g mode-keys vi  

### Status Bar Appearance ###

# Position status bar at the top
set -g status-position top

# Center-align status bar text
set -g status-justify absolute-centre

# Set status bar colors
set -g status-style 'fg=color7 bg=default'
set -g status-right ''  # Right side of status bar empty

# Set message box style (e.g. for prompts)
set -g message-style fg=colour51,bg=colour234

# Set command prompt style (bottom input box)
set -g message-command-style fg=colour51,bg=colour234

# Status line left side (show session name)
set -g status-left '#S'
set -g status-left-style 'fg=color8'

# Limit status line lengths
set -g status-right-length 0
set -g status-left-length 100

# Highlight active window
setw -g window-status-current-style 'fg=colour6 bg=default bold'
setw -g window-status-current-format '#I:#W '

# Style for inactive windows
setw -g window-status-style 'fg=color8'

### Vim-like Pane Navigation ###

# Go to last active window
bind -r p last-window
bind -r l next-window 
bind -r h previous-window 

# Move between panes using hjkl
bind -r k select-pane -L
bind -r j select-pane -R


# Custom scripts for session/project switching
bind-key f run-shell "tmux neww ~/.scripts/tmux-sessionizers"

bind-key e run-shell "tmux display-popup -w 55 -h 20 -E ~/.scripts/remote-search"


bind-key -r P run-shell "~/.scripts/tmux-sessionizer ~/documents/projects/"

bind-key -r o run-shell "am start --user 0 -n md.obsidian/md.obsidian.MainActivity"

bind-key -r s run-shell "tmux neww ~/.scripts/tmux-ls"
bind-key -r a run-shell "tmux neww ~/.scripts/tmux-launch-android-app"

# Toggle status bar visibility
bind-key b set-option status

### Plugins ###

# Load tmux-resurrect plugin
run-shell ~/.config/tmux/resurrect/resurrect.tmux

# tmux-resurrect options
set -g @resurrect-capture-pane-contents 'on'              # Save pane content
set -g @resurrect-processes 'ssh ping vim nvim htop top'  # Processes to restore
